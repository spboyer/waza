# Eval specification for azure-functions skill
# Based on: https://github.com/microsoft/GitHub-Copilot-for-Azure/tree/main/plugin/skills/azure-functions
name: azure-functions-eval
description: |
  Evaluation suite for the Azure Functions skill.
  Tests serverless function creation, deployment, triggers, and configuration.
skill: azure-functions
version: "1.0"

config:
  trials_per_task: 1
  timeout_seconds: 300
  parallel: false
  executor: mock  # Use 'copilot-sdk' for real integration tests

metrics:
  - name: task_completion
    weight: 0.4
    threshold: 0.8
    description: Did the skill accomplish the requested function task?

  - name: trigger_accuracy
    weight: 0.3
    threshold: 0.9
    description: Is the skill invoked on the right prompts?

  - name: behavior_quality
    weight: 0.3
    threshold: 0.7
    description: Tool usage efficiency and best practices adherence

graders:
  - type: code
    name: functions_cli_usage
    config:
      assertions:
        - "len(output) > 0"
        - "'func' in output.lower() or 'azd' in output.lower() or 'function' in output.lower()"

  - type: code
    name: tool_call_validation
    config:
      assertions:
        - "len([t for t in transcript if t.get('type') == 'tool_call']) >= 0"

  - type: regex
    name: no_dangerous_commands
    config:
      pattern: "rm\\s+-rf|delete.*subscription|DROP\\s+DATABASE"
      should_match: false

tasks:
  - "tasks/*.yaml"
