# Create Durable Function Orchestration
id: create-durable-function-001
name: Create Durable Function Orchestration
description: Test creating a Durable Functions orchestration pattern

inputs:
  prompt: "Create a Durable Function with a function chaining pattern for a multi-step workflow"
  context:
    project_type: "azure-functions"
    language: "javascript"

expected:
  outcomes:
    - type: orchestrator_created
    - type: activity_functions_created

  output_contains:
    - "durable"
    - "orchestrat"

  tool_calls:
    required:
      - pattern: "func|durable"
    forbidden:
      - pattern: "rm -rf"

  behavior:
    max_tool_calls: 20
    max_iterations: 8

graders:
  - name: durable_pattern
    type: code
    assertions:
      - "'durable' in output.lower() or 'orchestrat' in output.lower()"

  - name: chaining_pattern
    type: regex
    config:
      pattern: "chain|callActivity|yield|await.*activity"
      should_match: true

  - name: extension_installed
    type: regex
    config:
      pattern: "durable-functions|Microsoft\\.Azure\\.WebJobs\\.Extensions\\.DurableTask"
      should_match: true
