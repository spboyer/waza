# Deploy with GitHub Actions CI/CD
id: setup-cicd-001
name: Setup GitHub Actions CI/CD
description: Test setting up CI/CD pipeline for Azure Functions deployment

inputs:
  prompt: "Set up GitHub Actions to automatically deploy my Azure Function when I push to main"
  context:
    project_type: "azure-functions"
    language: "node"
    has_github_repo: true

expected:
  outcomes:
    - type: workflow_created
    - type: secrets_guidance_provided

  output_contains:
    - "github"
    - "action"
    - "workflow"

  tool_calls:
    required:
      - pattern: "github|workflow|yaml"
    forbidden:
      - pattern: "rm -rf"

  behavior:
    max_tool_calls: 20
    max_iterations: 8

graders:
  - name: workflow_file_created
    type: regex
    config:
      pattern: "\\.github/workflows|azure-functions\\.ya?ml"
      should_match: true

  - name: azure_login_action
    type: regex
    config:
      pattern: "azure/login|Azure/login|AZURE_CREDENTIALS"
      should_match: true

  - name: functions_action
    type: regex
    config:
      pattern: "Azure/functions-action|functions-action"
      should_match: true
